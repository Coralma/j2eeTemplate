angular.module("cccis.angular.common.business-components.closeBtn",["cccis.angular.common.components.dialog"]),angular.module("cccis.angular.common.businessComponents.codeTable",["cccis.angular.common.utils","cccis.angular.common.components.inputField"]),angular.module("cccis.angular.common.businessComponents.interceptor",["cccis.angular.common.utils"]),angular.module("cccis.angular.common.businessComponents.localArea",["cccis.angular.common.utils","cccis.angular.common.components.inputField"]),angular.module("cccis.angular.common.businessComponents.model-validation",[]),angular.module("cccis.angular.common.components.dialog",[]),angular.module("cccis.angular.common.components.grid",[]),angular.module("cccis.angular.common.components.inputField",["ui.bootstrap","ui.select","ui.bootstrap.datetimepicker","ngSanitize"]),angular.module("cccis.angular.common.components.loadingMask",[]),angular.module("cccis.angular.common.components.notify",[]),angular.module("cccis.angular.common.components.panel",[]),angular.module("cccis.angular.common.utils",["restangular"]),angular.module("cccis.angular.common.business-components.closeBtn").directive("cccisCloseBtn",["$q","cccisCommonDialogProvider",function(e,n){return{restrict:"E",transclude:!0,replace:!0,require:"^form",scope:{ngId:"@",caption:"@",dirtyFormCheck:"@",confirmMessage:"@",onCloseBtnClick:"="},template:'<input type="button" class="btn btn-primary" value="{{caption}}" ng-click="onBtnClicked()"></input>',link:function(o,t,i,l){o.onLoad=function(){o.caption=o.caption||"关 闭",o.dirtyFormCheck=o.dirtyFormCheck||"true",o.confirmMsg=o.confirmMsg||"您有未保存数据，确认离开此页面？"},o.onBtnClicked=function(){var t=e.defer();"true"==o.dirtyFormCheck&&l.$dirty?n.confirm(o.confirmMsg).then(function(e){1==e?t.resolve(!0):t.resolve(!1)}):t.resolve(!0),t.promise.then(function(e){1==e&&o.onCloseBtnClick()})},o.onLoad()}}}]),angular.module("cccis.angular.common.businessComponents.codeTable").directive("cccisCodeTableField",["cccisCodeTableUtils",function(e){return{require:"ngModel",restrict:"E",replace:!1,scope:{ngModel:"=",searchTitle:"@",codeTypeId:"@",hasEmptyOptionFlag:"@",emptyOptionText:"@",beforeOptionSelected:"=",onAfterOptionSelected:"="},link:function(n,o,t,i){n.onLoad=function(){if(n.codeTypeId){var o=e.getCodesByType(n.codeTypeId);o=_.sortBy(o,["codeId"]),"true"==n.hasEmptyOptionFlag&&o.unshift({codeId:null,text:n.emptyOptionText||n.searchTitle||""}),n.codes=o,n.$watch("ngModel",function(){var e=_.find(n.codes,{codeId:n.ngModel});n.codeModel=e}),n.$watch("codeModel",function(){n.ngModel=n.codeModel?n.codeModel.codeId:null})}},n.onLoad()},template:'<dropdown-field ng-model="codeModel" search-title="{{searchTitle}}" search-enabled="false" option-list="codes" option-value="codeId" option-text="text"></dropdown-field>'}}]),angular.module("cccis.angular.common.businessComponents.codeTable").filter("cccisCodeTableFilter",["cccisCodeTableUtils",function(e){return function(n,o){return e.getCodeValueByTypeAndCode(o,n)}}]),angular.module("cccis.angular.common.businessComponents.interceptor").factory("cccisHttpCacheInterceptor",["$q",function(e){return{request:function(n){var o=localStorage.getItem("version")||_.uniqueId();return n.url.indexOf("template/")<0&&n.url.indexOf("templates/")<0&&n.url.indexOf(".tpl.html")<0&&(n.url.indexOf("?")>=0?n.url+="&_t="+o:n.url+="?_t="+o),e.when(n)}}}]),angular.module("cccis.angular.common.businessComponents.localArea").filter("cccisLocalAreaDetailAddressFilter",["cccisLocalAreaUtils",function(e){return function(n){return e.buildWholeLocalAddress(n)}}]),angular.module("cccis.angular.common.businessComponents.model-validation").factory("cccisBaseValidateMethodProvider",function(){return{require:function(e,n,o){return 0==o?[]:null==e||""===e?[n+"不能为空。"]:[]},minLength:function(e,n,o){return"string"!=typeof e?null:e.length>=n?null:[that.getName(o)+"至少"+n+"个字符"]},maxLength:function(e,n,o){return"string"!=typeof e?null:e.length<=n?null:[that.getName(o)+"最长"+n+"个字符"]}}}),angular.module("cccis.angular.common.businessComponents.model-validation").directive("cccisControlName",["cccisModelValidation","$timeout",function(e,n){return{restrict:"A",link:function(o,t,i){$(t).on("change",function(o){e.isValidationProcessed()&&n(function(){var n=$(t).attr("control-name");e.validateControl(n)})})}}}]),angular.module("cccis.angular.common.businessComponents.model-validation").factory("cccisModelValidation",["cccisModelValidationResultService","$injector",function(cccisModelValidationResultService,$injector){var validationModelMame,validators=[],controlMap={},validateMethodProvider,afterValidationCallback,isValidationProcessedFlagMap={},VALIDATOR_SEQ=1,setValidateMethodProvider=function(e){validateMethodProvider=e},buildControlMap=function(){controlMap={},_.each(validators,function(e){var n=e.controlName;controlMap[n]||(controlMap[n]=[]),controlMap[n].push(e)})},initValidator=function(e,n,o){isValidationProcessedFlagMap={},validators=[],validationModelMame=e,addValidators(n),afterValidationCallback=o},isValidationProcessed=function(){var e=!1;return _.each(isValidationProcessedFlagMap,function(n,o){n&&(e=!0)}),e},isNodeValidationProcessed=function(e){var n=!1;return _.each(isValidationProcessedFlagMap,function(o,t){e==o&&(n=!0)}),n},addValidators=function(e){var n=this;_.each(e,function(e){addValidator.apply(n,e)}),buildControlMap()},addValidator=function(e,n,o,t,i,l){var a={seq:VALIDATOR_SEQ,tabName:e,controlName:n,nodes:o,errorType:t,validatorMethodName:i,validatorMethodParams:l,control:null,errorMsgArray:[]};VALIDATOR_SEQ++,validators.push(a)},clearValidatorsByControls=function(e,n){var o=null;e?_.each(n,function(n){var t=_.remove(validators,function(o){return o.tabName==e&&o.controlName==n});o=_.union(o,t)}):(o=validators,validators=[]),_.each(o,function(e){cccisModelValidationResultService.remove(e)}),afterValidationCallback&&_.each(isValidationProcessedFlagMap,function(e,n){1==e&&afterValidationCallback(!1,n,cccisModelValidationResultService.getResult())}),buildControlMap()},bindValidatorWithUIContent=function(e){var n=_.now(),o=[];o=e?$("[control-name]","."+e):$("[control-name]"),_.each(o,function(e){var n=$(e),o=n.attr("control-name"),t=controlMap[o];t&&_.each(t,function(e){e.control=n,cccisModelValidationResultService.refresh(e)})});var t=_.now();console.log("bindValidatorWithUIContent cost:"+(t-n)+"ms")},bindValidatorWithTabControls=function(e){var n=_.now(),o=[];o=e?$("[control-name]","div[ui-view="+e+"]"):$("[control-name]","div[ui-view]"),_.each(o,function(e){var n=$(e),o=n.attr("control-name"),t=controlMap[o];t&&_.each(t,function(e){e.control=n,cccisModelValidationResultService.refresh(e)})});var t=_.now();console.log("bindValidatorWithTabControls cost:"+(t-n)+"ms")},processValidation=function(validator,currentNode){if(!validationModelMame)return!0;var inNodeFlag=!1;if(!(inNodeFlag=currentNode?_.find(validator.nodes,function(e){return currentNode==e}):_.find(validator.nodes,function(e){var n=!1;return _.each(isValidationProcessedFlagMap,function(o,t){o==e&&(n=!0)}),1==n})))return!0;window[validationModelMame]=$injector.get(validationModelMame);var method=validateMethodProvider[validator.validatorMethodName];if(null==method)return console.log("could not find validator method:"+validator.validatorMethodName),!0;var paramValues=[];_.each(validator.validatorMethodParams,function(param){var paramValue=eval(param);paramValues.push(paramValue)});var msg=validateMethodProvider[validator.validatorMethodName].apply(this,paramValues),valid=!1;return msg&&msg.length>0?(validator.errorMsgArray=msg,valid=!1):valid=!0,delete window[validationModelMame],valid},validateControlBySuffix=function(e,n){_.each(controlMap,function(n,o){_.endsWith(o,e)&&validateControl(o,!0)}),afterValidationCallback&&0==n&&_.each(isValidationProcessedFlagMap,function(e,n){e&&afterValidationCallback(!1,e,cccisModelValidationResultService.getResult())})},setControlInvalidate=function(e,n){n=n||"errors";var o=controlMap[e];o.length>0&&cccisModelValidationResultService.setControlInvalidate(o[0].control,n)},setControlValidate=function(e,n){n=n||"errors";var o=controlMap[e];o.length>0&&cccisModelValidationResultService.setControlValidate(o[0].control,n)},validateControl=function(controlName,noCallbackFlag){var isValidationProcessedFlag=_.find(isValidationProcessedFlagMap,function(e,n){return!!e});if(isValidationProcessedFlag){var validators=controlMap[controlName];validators?_.each(validators,function(e){processValidation(e)?_.each(isValidationProcessedFlagMap,function(n,o){n&&_.includes(e.nodes,n)&&cccisModelValidationResultService.remove(e,o)}):_.each(isValidationProcessedFlagMap,function(n,o){n&&_.includes(e.nodes,n)&&cccisModelValidationResultService.add(e,o)})}):console.log("could not find validatorControl for "+controlName);var controlElem=$("[control-name="+controlName+"]"),triggerAttr=controlElem.attr("validation-trigger");if(triggerAttr){var triggerControlNames=eval(triggerAttr);_.each(triggerControlNames,function(e){validateControl(e)})}afterValidationCallback&&1!=noCallbackFlag&&_.each(isValidationProcessedFlagMap,function(e,n){e&&afterValidationCallback(!1,n,e,cccisModelValidationResultService.getResult())})}},executeValidation=function(e,n,o){return e||alert("validationType should not be null"),n||alert("validationNode should not be null"),o||(o=n),this.resetValidation(e),isValidationProcessedFlagMap[e]=n,_.each(validators,function(o){processValidation(o,n)||cccisModelValidationResultService.add(o,e)}),afterValidationCallback&&afterValidationCallback(!0,e,o,cccisModelValidationResultService.getResult()),cccisModelValidationResultService.getResult()},resetValidation=function(e){isValidationProcessedFlagMap[e]=null,cccisModelValidationResultService.resetValidationResult(e)};return{isValidationProcessed:isValidationProcessed,isNodeValidationProcessed:isNodeValidationProcessed,initValidator:initValidator,clearValidatorsByControls:clearValidatorsByControls,addValidators:addValidators,bindValidatorWithUIContent:bindValidatorWithUIContent,bindValidatorWithTabControls:bindValidatorWithTabControls,setValidateMethodProvider:setValidateMethodProvider,executeValidation:executeValidation,resetValidation:resetValidation,validateControl:validateControl,validateControlBySuffix:validateControlBySuffix,setControlInvalidate:setControlInvalidate,setControlValidate:setControlValidate}}]),angular.module("cccis.angular.common.businessComponents.model-validation").factory("cccisModelValidationResultService",["$timeout","$interval","$q",function(e,n,o){var t=function(e,n){return _.filter(c.validatorResultMap[e],function(e){return e.errorType==n})},i=function(e,n){"errors"==n&&$(e).addClass("cccis-model-validation-data-error"),"warnings"==n&&$(e).addClass("cccis-model-validation-data-warning")},l=function(e,n){if(e&&(null!=n?_.remove(c.validatorResultMap[n],function(n){return n.tabName==e.tabName&&n.controlName==e.controlName&&n.errorType==e.errorType&&n.validatorMethodName==e.validatorMethodName&&n.seq==e.seq}):_.each(c.validatorResultMap,function(n){_.remove(n,function(n){return n.tabName==e.tabName&&n.controlName==e.controlName&&n.errorType==e.errorType&&n.validatorMethodName==e.validatorMethodName&&n.seq==e.seq})}),e.control)){var o=!1;if(_.each(c.validatorResultMap,function(n){_.find(n,function(n){return n.tabName==e.tabName&&n.controlName==e.controlName&&n.errorType==e.errorType})&&(o=!0)}),o)return;e.control&&a($(e.control),e.errorType)}},a=function(e,n){"errors"==n&&$(e).removeClass("cccis-model-validation-data-error"),"warnings"==n&&$(e).removeClass("cccis-model-validation-data-warning")},c={validatorResultMap:{},getValidationItemCount:function(e,n){return t(e,n).length},getValidationMsgCount:function(e,n){var o=0,i=t(e,n);return _.each(i,function(e){o+=e.errorMsgArray.length}),o},getValidators:t};return{getResult:function(){return _.each(c.validatorResultMap,function(e,n){c.validatorResultMap[n]=_.sortBy(e,["seq","validatorMethodName"])}),c},resetValidationResult:function(e){var n=c.validatorResultMap[e];c.validatorResultMap[e]=[],_.each(n,function(n){l(n,e)})},add:function(e,n){e&&(_.find(c.validatorResultMap[n],function(n){return n.tabName==e.tabName&&n.controlName==e.controlName&&n.errorType==e.errorType&&n.validatorMethodName==e.validatorMethodName&&n.seq==e.seq})||(c.validatorResultMap[n]||(c.validatorResultMap[n]=[]),c.validatorResultMap[n].push(e)),e.control&&i($(e.control),e.errorType))},remove:l,refresh:function(e){if(e&&e.control){var n=!1;_.each(c.validatorResultMap,function(o){_.include(o,e)&&(n=!0)}),n&&("errors"==e.errorType&&$(e.control).addClass("cccis-model-validation-data-error"),"warnings"==e.errorType&&$(e.control).addClass("cccis-model-validation-data-warning"))}},setControlInvalidate:i,setControlValidate:a}}]),angular.module("cccis.angular.common.businessComponents.model-validation").controller("cccisValidationResultDialogCtrl",["$scope","$timeout","$q","$parentScope","$interval",function(e,n,o,t,i){e.init=function(){},e.setAllowSubmitFlag=function(n,o){e.allowSubmitFlag=n,e.submitFunc=o},e.setValidationResult=function(o,i,l,a,c){e.isMultiValidationTypeFlag=o,e.validationErrorResultMap=e.validationErrorResultMap||{};var r=e.validationErrorResultMap[i.key];e.validationErrorResultMap[i.key]?r=e.validationErrorResultMap[i.key]:(r={title:"",errorNum:0,warningNum:0,errors:{},warnings:{}},e.validationErrorResultMap[i.key]=r),r.key=i.key,r.title=i.text,r.errorNum=l.getValidationItemCount(i.key,"errors"),r.warningNum=l.getValidationItemCount(i.key,"warnings"),r.submitFunc=c,r.showDividingLineFlag=r.errorNum&&r.warningNum,r.errors={},r.warnings={};var s={};t&&t.tabs&&_.each(t.tabs,function(e){s[e.templateUrl]=e.heading}),_.each(l.validatorResultMap[i.key],function(e){if(_.find(e.nodes,function(e){return _.startsWith(e,i.key)})){var n=null==s[e.tabName]?e.tabName:s[e.tabName];r[e.errorType][n]=r[e.errorType][n]||[],r[e.errorType][n].push(e)}}),n(function(){var e=$("#msg-id-"+r.key);e.length>0&&e[0].scrollIntoView(!0)})},e.locateValidator=function(n){if(n){var i=o.defer();n.tabName&&t.enterTab?t.enterTab(n.tabName).then(function(){i.resolve(!0)}):i.resolve(!0),i.promise.then(function(){e.notice(n.control)})}},e.notice=function(e){if(e){var n,o=e.attr("in-grid");angular.isUndefined(o)||(n=e.closest("tr")),e[0].scrollIntoView(!1);var t=5,l=!1,a=i(function(){l=!l,--t<0&&i.cancel(a),n?l?n.addClass("flashing"):n.removeClass("flashing"):l?e.addClass("flashing"):e.removeClass("flashing")},250)}},e.init()}]),angular.module("cccis.angular.common.components.dialog").controller("cccisAlertCtrl",["$scope","content",function(e,n){e.content=n,e.result=null,e.closeAlert=function(){e.result=!0,e.dialogApi.close()}}]),angular.module("cccis.angular.common.components.dialog").controller("cccisAppErrorDialogCtrl",["$scope","content",function(e,n){e.content=n,e.result=null,e.closeAlert=function(){e.result=!0,e.dialogApi.close()}}]),angular.module("cccis.angular.common.components.dialog").controller("cccisConfirmCtrl",["$scope","content","data",function(e,n,o){e.content=n,e.data=o,e.result=null,e.confirm=function(){e.result=!0,e.dialogApi.close()},e.cancel=function(){e.result=!1,e.dialogApi.close()}}]),angular.module("cccis.angular.common.components.dialog").factory("cccisCommonDialogProvider",["cccisDialogProvider","$q",function(e,n){return{alert:function(o,t){var i=n.defer();return e.openDialog({templateUrl:"common/components/dialog/dialog-alert.tpl.html",controllerName:"cccisAlertCtrl",resolves:{content:o},options:{title:null==t||null==t.title?"":t.title,width:null==t||null==t.width?"400px":t.width,height:null==t||null==t.height?"180px":t.height,modal:!0,collapsible:null!=t&&null!=t.title&&t.collapsible,enableDrag:null==t||null==t.enableDrag||t.enableDrag,sizeType:null==t||null==t.sizeType?"small":t.sizeType,dialogCls:"cccis-common-dialog cccis-alert-dialog"}}).then(function(e){e.onDialogClose=function(){i.resolve(e.result)}}),i.promise},confirm:function(o,t,i){var l=n.defer();return t=t||{},e.openDialog({templateUrl:"common/components/dialog/dialog-confirm.tpl.html",controllerName:"cccisConfirmCtrl",options:angular.extend({title:null==t||null==t.title?"":t.title,width:null==t||null==t.width?"400px":t.width,height:null==t||null==t.height?"180px":t.height,modal:!0,collapsible:null!=t&&null!=t.title&&t.collapsible,enableDrag:null==t||null==t.enableDrag||t.enableDrag,sizeType:null==t||null==t.sizeType?"small":t.sizeType,dialogCls:"cccis-common-dialog cccis-confirm-dialog"},t),resolves:{data:angular.extend({},i),content:o}}).then(function(e){e.onDialogClose=function(){l.resolve(e.result)}}),l.promise},showAppErrorDialog:function(n,o){return e.openDialog({templateUrl:"common/components/dialog/dialog-alert.tpl.html",controllerName:"cccisAppErrorDialogCtrl",resolves:{content:n},options:{title:null==o||null==o.title?"注意":o.title,width:null==o||null==o.width?"400px":o.width,height:null==o||null==o.height?"180px":o.height,modal:!0,collapsible:null!=o&&null!=o.title&&o.collapsible,enableDrag:null==o||null==o.enableDrag||o.enableDrag,sizeType:null==o||null==o.sizeType?"small":o.sizeType,dialogCls:"cccis-common-dialog cccis-alert-dialog"}})}}}]),angular.module("cccis.angular.common.components.dialog").directive("cccisDialog",["$compile","$timeout",function(e,n){return{restrict:"EA",scope:{options:"=",api:"="},replace:!0,transclude:!0,link:function(e,o,t){e.onLoad=function(){t.popupPanelId||t.$set("cccisDialogId","cccis_dialog_"+(new Date).getTime()),e.options.title=e.options.title||"",e.options.isVisible=null==e.options.isVisible||e.options.isVisible,e.options.hasHead=null==e.options.hasHead||e.options.hasHead,e.options.autoHide=null==e.options.autoHide||e.options.autoHide,e.options.collapsible=null!=e.options.collapsible&&e.options.collapsible,e.options.collapsed=null!=e.options.collapsed&&e.options.collapsed,e.options.closable=null==e.options.closable||e.options.closable,e.options.closeText=e.options.closeText||"关闭",e.options.enableDrag=null==e.options.enableDrag||e.options.enableDrag,e.options.modal=null==e.options.modal||e.options.modal,e.options.dialogCls=e.options.dialogCls||"",e.options.headCls=e.options.headCls||"",e.options.bodyCls=e.options.bodyCls||"",e.options.bodyStyle=e.options.bodyStyle||"",e.options.sizeType=e.options.sizeType||"","large"==e.options.sizeType?(e.options.width="1336px",e.options.height="648px"):"medium"==e.options.sizeType?(e.options.width="800px",e.options.height="500px"):"mediumAndSmall"==e.options.sizeType?(e.options.width="410px",e.options.height="300px"):"small"==e.options.sizeType?(e.options.width="400px",e.options.height="180px"):(e.options.width=e.options.width||"410px",e.options.height=e.options.height||"300px"),e.initData()},e.initData=function(){e.apiWatcher=e.$watch("api",function(n,t){e.api&&(e.api.open=e.open,e.api.isOpened=e.isOpened,e.api.setCloseFlag=e.setCloseFlag,e.api.close=e.close,e.api.setToTopLayer=e.setToTopLayer,e.api.setToCenter=e.setToCenter,e.api.element=o)}),e.collapseWatcher=e.$watch("options.collapsed",function(n,t){e.options.collapsed?o.css("height","auto"):o.css("height",e.options.height)}),e.maskElement=null,e.diviation={x:0,y:0},e.mouseMoveHandler=null,e.mouseUpHandler=null,n(function(){e.headEle=$(".head",o),e.open(),e.setToTopLayer(),e.setToCenter()})},e.headMouseDown=function(n){e.setToTopLayer(),e.options.enableDrag&&(e.headMouseUp(),e.dragging=!0,e.headEle.setCapture&&e.headEle.setCapture(),e.diviation.x=n.pageX-o.offset().left,e.diviation.y=n.pageY-o.offset().top,e.mouseMoveHandler=$(window).bind("mousemove",function(n){e.headMouseMove(n)}),e.mouseUpHandler=$(window).bind("mouseup",function(n){e.headMouseUp(n)}))},e.headMouseMove=function(n){if(e.options.enableDrag){if(!e.dragging)return;o.css("left",n.clientX-e.diviation.x+"px"),o.css("top",n.clientY-e.diviation.y+"px")}},e.headMouseUp=function(){e.options.enableDrag&&(e.dragging=!1,null!=e.mouseMoveHandler&&($(window).unbind("mousemove",e.mouseMoveHandler),e.mouseMoveHandler=null),null!=e.mouseUpHandler&&($(window).unbind("mouseup",e.mouseUpHandler),e.mouseUpHandler=null),e.headEle.releaseCapture&&e.headEle.releaseCapture())},e.toggle=function(){e.options.collapsed?e.expand():e.collapse()},e.expand=function(){e.options.collapsed=!1},e.collapse=function(){e.options.collapsed=!0},e.open=function(){if(o.css({left:"0px",top:"0px"}),e.options.isVisible=!0,1==e.options.modal){if(null==e.maskElement){e.maskElement=$('<div class="cccis-dialog-mask"></div>')}var t=$(document).outerWidth()>$(window).width()?$(document).outerWidth()-1:"100%",i=$(document).outerHeight()>$(window).height()?$(document).outerHeight():$(window).height();e.maskElement.width(t),e.maskElement.height(i),$("body").append(e.maskElement)}1==e.options.autoHide&&n(function(){$(document).one("click",e.closeFun)},500),o.show()},e.closeFun=function(n){$(n.target).closest(".cccis-dialog").length<=0?e.close():$(document).one("click",e.closeFun)},e.isOpened=function(){return e.options.isVisible},e.setCloseFlag=function(n){e.$parent.canNotClose=n},e.close=function(){e.$parent&&e.$parent.canNotClose?$(document).one("click",e.closeFun):e.$parent&&e.$parent.beforeDialogClose&&1!=e.$parent.beforeDialogClose()||(e.options.isVisible=!1,1==e.options.modal&&null!=e.maskElement&&(e.maskElement.remove(),e.maskElement=null),o.remove(),e.apiWatcher&&e.apiWatcher(),e.collapseWatcher&&e.collapseWatcher(),e.$parent&&e.$parent.onDialogClose&&e.$parent.onDialogClose())},e.setToTopLayer=function(){var n=0,t=$(".cccis-dialog");if(t.length>0){t.removeClass("active");var i=_.max(t,function(e){var n=parseInt(e.style.zIndex);return isNaN(n)?0:n});n=parseInt(i.style.zIndex),n=isNaN(n)?0:n}o.addClass("active"),0!=n&&$(i).attr("cccis-dialog-id")==o.attr("cccis-dialog-id")||(0==n&&(n=19999),o.css("z-index",n+1),1==e.options.modal&&null!=e.maskElement&&e.maskElement.css("z-index",n))},e.setToCenter=function(e){var n=$(window).width(),t=$(window).height(),i=(n-o.width())/2,l=(t-o.height())/2;o.css({left:i+"px",top:l+"px"})},e.onLoad()},template:'<div ng-show="options.isVisible" ng-style="{width: options.width, height: options.height}" class="cccis-dialog {{options.dialogCls}}" ng-class="{\'cccis-dialog-with-head\':options.hasHead,\'cccis-dialog-no-head\':!options.hasHead}">   <div ng-if="options.hasHead" ng-mousedown="headMouseDown($event)" class="head {{options.headCls}}">       <div style="flex:1">{{options.title}}</div>       <div ng-if="options.collapsible" ng-click="toggle()" ng-class="{true:\'head-btn glyphicon glyphicon-triangle-top\',false:\'head-btn glyphicon glyphicon-triangle-bottom\'}[options.collapsed]" style="cursor: pointer;"/>       <div ng-if="options.closable" title="{{options.closeText}}" ng-click="close()" class="head-btn icon close-icon"/>   </div>   <div ng-if="!options.hasHead" class="no-head">       <span ng-if="options.closable" title="{{options.closeText}}" ng-click="close()" class="head-btn glyphicon glyphicon-remove"/>   </div>   <div class="body {{options.bodyCls}}" style="" ng-show="!options.collapsed">       <div ng-transclude>/   </div></div>'}}]),angular.module("cccis.angular.common.components.dialog").provider("cccisDialogProvider",["$injector",function(e){var n={title:"",isVisible:!0,hasHead:!0,autoHide:!1,collapsible:!1,collapsed:!1,closable:!0,closeText:"close",enableDrag:!0,modal:!0,dialogCls:"",headCls:"",bodyCls:"",bodyStyle:"",height:"300px",width:"400px"},o=0,t=function(){return"cccis_dialog_"+ ++o};return{$get:function(o,i,l,a,c,r,s,d){function u(e){var n=i.get(e);return n||o(e)}function p(n){var o=[];return _.each(n,function(n){angular.isFunction(n)||angular.isArray(n)?o.push(s.when(e.invoke(n))):o.push(s.when(n))}),o}return{openDialog:function(e){var o=e.templateUrl,i=e.controllerName,r=_.assign(angular.copy(n),e.options),g=e.resolves,m=s.defer(),f=m.promise;return s.all([u(o)].concat(p(g))).then(function(e){var n=e[0],o=angular.element('<cccis-dialog api="dialogApi" options="options">'+n+"</cccis-dialog>"),s=a.$new(),u={$scope:s},p=1;angular.forEach(g,function(n,o){u[o]=e[p++]}),l(i,u),s.dialogId=t(),s.options=r,s.dialogApi={};var f=c(o)(s);f.hide(),$("body").append(f),d(function(){s.onDialogResize&&s.onDialogResize(),m.resolve(s)})}),f}}}}}]),angular.module("cccis.angular.common.components.grid").directive("cellCompiler",["$compile",function(e){return{restrict:"A",link:function(n,o,t){n.$watch(t.cellCompiler,function(t){var i=angular.element(t);o.append(i),e(i)(n)})}}}]),angular.module("cccis.angular.common.components.grid").directive("cccisPaginationBar",function(){return{restrict:"E",link:function(e,n,o){e.onLoad=function(){e.$watch("options.totalRecordCount",function(){console.log("totalRecordCount changed"),e.options.currentPage=1,e.options.currentGroup=1,e.pageChange(!1)},!0),e.$watch("options.pageItemSize",function(){console.log("pageItemSize changed"),e.options.currentPage=1,e.options.currentGroup=1,e.pageChange(!0)},!0)},e.options.resetPage=function(){e.options.currentPage=1,e.options.currentGroup=1,e.pageChange(!1)},e.pageChange=function(n){e.options.totalRecordCount=e.options.totalRecordCount||0,e.maxPageNum=parseInt((e.options.totalRecordCount-1)/e.options.pageItemSize+1),e.maxGroupNum=parseInt((e.maxPageNum-1)/e.options.groupItemSize+1),e.options.currentGroup=parseInt((e.options.currentPage-1)/e.options.groupItemSize+1),e.firstPageInCurrentGroup=(e.options.currentGroup-1)*e.options.groupItemSize+1,e.lastPageInCurrentGroup=e.options.currentGroup*e.options.groupItemSize,e.lastPageInCurrentGroup=e.lastPageInCurrentGroup>e.maxPageNum?e.maxPageNum:e.lastPageInCurrentGroup,e.pageArray=[];for(var o=e.firstPageInCurrentGroup;o<=e.lastPageInCurrentGroup;o++)e.pageArray.push(o);n&&e.onPaginationChange&&e.onPaginationChange(e.options.currentPage,e.options.pageItemSize),e.allRowCheckedFlag=!1},e.gotoPage=function(n){n<=0&&(n=1),n>e.maxPageNum&&(n=e.maxPageNum),e.options.currentPage=n,e.pageChange(!0)},e.onLoad()},templateUrl:"common/components/grid/pagination-bar.tpl.html"}}),angular.module("cccis.angular.common.components.grid").directive("cccisPaginationGrid",["$timeout","$window",function(e,n){return{restrict:"E",replace:!0,scope:{options:"=",onRowSelected:"=",onRowChecked:"=",onAllRowChecked:"=",onRowDbClicked:"=",onPaginationChange:"=",onSortChanged:"=",api:"="},link:function(e,n,o){e.onLoad=function(){e.options.gridHighlightCellStyleFlag=e.options.gridHighlightCellStyleFlag||!0,e.options.rowSelectable=e.options.rowSelectable||!1,e.options.rowCheckable=e.options.rowCheckable||!1,e.options.multiRowCheckable=e.options.multiRowCheckable||!1,e.options.useExternalPagination=e.options.useExternalPagination||!1,e.options.noDataMessage=e.options.noDataMessage||"没有找到匹配的结果。",e.options.pageItemSize=e.options.pageItemSize||10,e.appScope=e.$parent,e.options.currentPage=1,e.options.currentGroup=0,e.options.pageItemSize=10,e.options.groupItemSize=5,e.$watch("api",function(n,o){e.api&&(e.api.reload=e.reload,e.api.getCheckedRows=e.getCheckedRows,e.api.checkAllRows=e.checkAllRows,e.api.setGridData=e.setGridData,e.api.resetPage=e.resetPage)}),e.$watch("options.columnDefs",function(n,o){e.initColumns()})},e.reload=function(){e.onLoad()},e.resetPage=function(){e.options.resetPage()},e.initColumns=function(){e.columns=_.filter(e.options.columnDefs,function(e){return 1!=e.hidden}),e.columnCount=e.columns.length,e.options.gridHighlightCellStyleFlag&&e.columnCount++,e.options.rowCheckable&&e.columnCount++},e.setGridData=function(n,o){e.gridData=n,e.options.useExternalPagination||(e.gridDataBak=angular.copy(e.gridData)),e.options.totalRecordCount=o},e.sortData=function(n,o){if(n.enableSorting){var t={};if(_.forEach(o,function(e){n.field!=e.field&&(e.sort=null)}),null==n.sort?n.sort="desc":"desc"==n.sort?n.sort="asc":"asc"==n.sort&&(n.sort=null),e.options.useExternalPagination){if(e.onSortChanged){var i=null==n.sort?null:n.field;e.onSortChanged(e.options.currentPage,e.options.pageItemSize,i,n.sort)}}else null==n.sort?t=e.gridDataBak:"asc"==n.sort?t=_.sortBy(e.gridData,n.field):"desc"==n.sort&&(t=_.sortBy(e.gridData,n.field).reverse()),angular.copy(t,e.gridData)}},e.checkAllRows=function(n,o){e.options.rowCheckable&&e.options.multiRowCheckable&&(e.allRowCheckedFlag=null!=n?n:!e.allRowCheckedFlag,e.onAllRowChecked&&1!=o&&e.onAllRowChecked(e.allRowCheckedFlag),_.forEach(e.gridData,function(n){0!=n.$checkable&&(n.$checked=e.allRowCheckedFlag)}))},e.checkRow=function(n){e.options.rowCheckable&&0!=n.$checkable&&(0==e.options.multiRowCheckable&&_.forEach(e.gridData,function(o){o!=n&&(o.$selected=!1,e.onRowSelected&&e.onRowSelected(o,!1))}),n.$checked=!!n.$checked,e.onRowChecked&&e.onRowChecked(n,n.$checked),e.updateRowCheckedFlag())},e.updateRowCheckedFlag=function(){if(null!=e.gridData&&0!=e.gridData.length){var n=_.find(e.gridData,function(e){return!e.$checked&&0!=e.$checkable});e.allRowCheckedFlag=null==n}else e.allRowCheckedFlag=!1},e.getCheckedRows=function(){if(e.options.rowCheckable){var n=[];return _.forEach(e.gridData,function(e){e.$checked&&n.push(e)}),n}return[]},e.selectRow=function(n){e.options.rowSelectable&&(_.forEach(e.gridData,function(o){o!=n&&(o.$selected=!1,e.onRowSelected&&e.onRowSelected(o,!1))}),n.$selected=!0,e.onRowSelected&&e.onRowSelected(n,!0))},e.unSelectedAllRows=function(){e.options.rowSelectable&&_.forEach(e.gridData,function(n){n.$selected=!1,e.onRowSelected&&e.onRowSelected(n,!1)})},e.getTemplate=function(){return e.options.fixedHeightFlag?"common/components/grid/fixed-height-pagination-grid.tpl.html":"common/components/grid/auto-height-pagination-grid.tpl.html"},e.onLoad()},template:"<div ng-include='getTemplate()'></div>"}}]),angular.module("cccis.angular.common.components.grid").directive("cccisSimpleFixedHeightGrid",["$timeout","$window",function(e,n){return{restrict:"E",replace:!0,scope:{options:"=",api:"="},link:function(e,n,o){e.onLoad=function(){e.options.noDataMessage=e.options.noDataMessage||"没有找到匹配的结果。",e.options.useExternalPagination=e.options.useExternalPagination||!1,e.appScope=e.$parent,e.$watch("api",function(n,o){e.api&&(e.api.setGridData=e.setGridData)}),e.initColumns(),e.options.gridData&&e.setGridData(e.options.gridData)},e.initColumns=function(){e.columns=e.options.columnDefs,e.columnCount=e.columns.length},e.sortData=function(n,o){if(n.enableSorting){var t={};if(_.forEach(o,function(e){n.field!=e.field&&(e.sort=null)}),null==n.sort?n.sort="desc":"desc"==n.sort?n.sort="asc":"asc"==n.sort&&(n.sort=null),e.options.useExternalPagination){if(e.onSortChanged){var i=null==n.sort?null:n.field;e.onSortChanged(e.options.currentPage,e.options.pageItemSize,i,n.sort)}}else null==n.sort?t=e.gridDataBak:"asc"==n.sort?t=_.sortBy(e.gridData,n.field):"desc"==n.sort&&(t=_.sortBy(e.gridData,n.field).reverse()),angular.copy(t,e.gridData)}},e.setGridData=function(n){e.gridData=n,e.options.useExternalPagination||(e.gridDataBak=angular.copy(e.gridData))},e.onLoad()},template:'<div class="cccis-pagination-grid cccis-fixed-height-pagination-grid cccis-simple-fixed-height-grid">   <div class="head-container">       <table class="table table-bordered cccis-table">       <thead>           <tr>               <th ng-repeat="col in columns" ng-class="{\'cursor-pointer\':col.enableSorting==true}" ng-style="col.headStyle" ng-click="sortData(col, columns)">                   <div title="{{::col.displayName}}">{{::col.displayName}}</div>                   <div ng-if="col.sort == \'desc\'"><i class="glyphicon glyphicon-triangle-bottom"></i></div>                   <div ng-if="col.sort == \'asc\'"><i class="glyphicon glyphicon-triangle-top"></i></div>               </th>           </tr>       </thead>       </table>   </div>   <div class="content-container">       <table class="table table-bordered cccis-table">       <thead>           <tr>               <th ng-repeat="col in columns" ng-style="col.headStyle" >                   <div>{{::col.displayName}}</div>               </th>           </tr>       </thead>       <tbody class="no-data-found" ng-if="gridData == null || gridData.length==0">           <tr>               <td colspan="{{::columnCount}}">                   <div style="height:50px;">{{::options.noDataMessage}}</div>               </td>           </tr>       </tbody>       <tbody class="data-found" ng-if="gridData.length>0">           <tr ng-repeat="row in gridData">               <td ng-repeat="col in columns" class="{{::col.cellClass}}" ng-style="col.cellStyle">                   <div ng-if="col.cellTemplate" cell-compiler="col.cellTemplate"></div>                   <div ng-if="!col.cellTemplate" title="{{row[col.field]}}">{{row[col.field]}}</div>               </td>           </tr>       </tbody>       </table>   </div></div>'}}]),angular.module("cccis.angular.common.components.inputField").directive("cccisCheckboxField",["$timeout",function(e){return{restrict:"E",replace:!0,scope:{caption:"@",ngDisabled:"=",ngModel:"=",checkboxFieldClass:"@",onChecked:"&"},template:'<div class="cccis-checkbox-field {{checkboxFieldClass}}" ng-click="toggle()" title="{{caption}}">   <div ng-class="{       \'field icon checkbox-normal-unchecked-icon\' : (ngModel!=true && ngDisabled!=true),        \'field icon checkbox-normal-checked-icon\': (ngModel==true && ngDisabled!=true),       \'field cursor-not-allowed icon checkbox-disabled-checked-icon\': (ngModel==true && ngDisabled==true),       \'field cursor-not-allowed icon checkbox-disabled-unchecked-icon\': (ngModel!=true && ngDisabled==true)        }"></div>   <div ng-if="caption" class="caption">{{caption}}</div></div>',link:function(n,o,t){"true"==n.ngModel&&(n.ngModel=!0),n.caption=n.caption||"",n.caption&&(n.paddingLeft="padding-left:41px;"),n.toggle=function(){1!=n.ngDisabled&&(n.ngModel=!n.ngModel,n.onChecked&&e(n.onChecked))}}}}]),angular.module("cccis.angular.common.components.inputField").directive("cccisCheckboxGroupField",["$timeout",function(e){return{restrict:"E",replace:!0,scope:{ngModel:"=",optionList:"=",optionText:"@",optionValue:"@",resultMode:"@",onItemChanged:"="},template:'<div class="cccis-checkbox-group-field {{checkboxGroupFieldClass}}">   <cccis-checkbox-field ng-repeat="option in optionList" ng-model="option.$status" caption="{{option[optionText]}}"            on-checked="onCheckboxOptionChecked(option)">   </cccis-checkbox-field></div>',link:function(n,o,t){n.resultMode=n.resultMode||"1",n.isCheckboxSelected=function(e){return _.includes(n.ngModel,e[n.optionValue])},n.onCheckboxOptionChecked=function(t){n.ngModel?n.ngModel.splice(0,n.ngModel.length):n.ngModel=[],_.each(n.optionList,function(e){"1"==n.resultMode&&e.$status&&n.ngModel.push(e[n.optionValue]),"2"==n.resultMode&&n.ngModel.push(e.$status)}),n.onItemChanged&&e(function(){n.onItemChanged(t)});var i=document.createEvent("HTMLEvents");return i.initEvent("change",!0,!0),i.eventType="message",o[0].dispatchEvent?o[0].dispatchEvent(i):o[0].fireEvent?o[0].fireEvent("onchange",i):void 0}}}}]),angular.module("cccis.angular.common.components.inputField").directive("cccisDropDownBasicField",["$timeout","$q",function(e,n){return{require:"ngModel",restrict:"E",replace:!0,scope:{ngId:"@",ngModel:"=",placeholder:"@",allowClear:"@",ngDisabled:"@",dropDownBasicFieldClass:"@",optionList:"=",optionText:"@",optionValue:"@",beforeOptionSelected:"=",afterOptionSelected:"="},template:'<div class="cccis-drop-down-field drop-down-basic-field input-group {{dropDownBasicFieldClass}}" ng-class="{\'disabled\': ngDisabled}">   <select class="form-control select2"></select></div>',link:function(o,t,i,l){o.onLoad=function(){o.select2Elem=$("select",t),o.select2Options={data:{results:[],id:o.optionValue,text:o.optionText},allowClear:"true"==o.allowClear,minimumResultsForSearch:1/0,multiple:!1,placeholder:o.placeholder||"请选择",width:"resolve",language:{inputTooShort:function(){return"You must enter more characters..."}}},o.select2Elem.on("select2:select",function(n){e(function(){var e=o.select2Elem.val();o.onOptionSelected(e)})}),o.select2Elem.on("select2:opening",function(n){e(function(){$(".drop-down-field",t).addClass("focus"),$(".form-control",t).select()})}),o.select2Elem.on("select2:closing",function(n){e(function(){$(".drop-down-field",t).removeClass("focus")})}),o.$watch("ngModel",function(){o.selectOption(o.ngModel)}),o.$watch("optionText",function(){o.updateWidgetOptions("data.text",o.optionText)}),o.$watch("optionValue",function(){o.updateWidgetOptions("data.value",o.optionValue)}),o.$watch("optionList",function(){o.updateWidgetOptions("data.result",o.optionList),o.selectOption(o.ngModel)}),o.select2Elem.select2({placeholder:o.placeholder,allowClear:"true"==o.allowClear})},o.mapToSelect2OptionItem=function(e){return e&&o.select2Options.data?_.find(o.select2Options.data,function(n){return n.id==e[o.optionValue]}):null},o.mapToNgModelOptionItem=function(e){return e&&o.optionList?_.find(o.optionList,function(n){return e.id==n[o.optionValue]}):null},o.updateWidgetOptions=function(e,n){_.set(o.select2Options,e,n),o.select2Elem.select2(o.select2Options)},o.onOptionSelected=function(e){var t=o.beforeOptionSelected||function(){return!0},i=o.afterOptionSelected||function(){return!0};n.when(t(e)).then(function(t){1==t?(o.ngModel=e,n.when(i(e)).then(function(){})):o.selectOption(o.ngModel)})},o.selectOption=function(e){null==e?o.select2Elem.val(null).trigger("change"):o.select2Elem.val(e).trigger("change")},o.onLoad()}}}]),angular.module("cccis.angular.common.components.inputField").directive("dropDownExtQueryField",["$timeout","$q",function(e,n){return{require:"ngModel",restrict:"E",replace:!0,scope:{ngId:"@",ngModel:"=",placeholder:"@",allowClear:"@",ngDisabled:"@",dropDownExtQueryFieldClass:"@",minimumInputLength:"@",ajaxUrl:"@",optionText:"@",optionValue:"@",beforeOptionSelected:"=",onAfterOptionSelected:"="},template:'<div class="cccis-drop-down-field cccis-drop-down-ext-query-field input-group {{dropDownExtQueryFieldClass}}" ng-class="{\'disabled\': ngDisabled}">   <select class="form-control select2"></select></div>',link:function(o,t,i,l){o.onLoad=function(){o.select2Elem=$("select",t),o.select2Options={data:{results:[],id:o.optionValue,text:o.optionText},allowClear:"true"==o.allowClear,minimumInputLength:o.minimumInputLength,minimumResultsForSearch:"true"!=o.searchEnabled?1/0:10,multiple:!1,placeholder:o.placeholder||"请选择",width:"resolve",language:{inputTooShort:function(){return"You must enter more characters..."}},ajax:{url:function(e){return o.ajaxUrl},dataType:"json",data:function(e){return{keyword:e.term}},cache:!1}},o.select2Elem.on("select2:select",function(n){e(function(){var e=o.select2Elem.val();o.onOptionSelected(e)})}),o.select2Elem.on("select2:opening",function(n){e(function(){$(".drop-down-field",t).addClass("focus"),$(".form-control",t).select()})}),o.select2Elem.on("select2:closing",function(n){e(function(){$(".drop-down-field",t).removeClass("focus")})}),o.$watch("ngModel",function(){o.selectOption(o.ngModel)}),o.$watch("optionText",function(){o.updateWidgetOptions("data.text",o.optionText)}),o.$watch("optionValue",function(){o.updateWidgetOptions("data.value",o.optionValue)}),o.select2Elem.select2({placeholder:o.placeholder,allowClear:"true"==o.allowClear})},o.mapToSelect2OptionItem=function(e){return e&&o.select2Options.data?_.find(o.select2Options.data,function(n){return n.id==e[o.optionValue]}):null},o.updateWidgetOptions=function(e,n){_.set(o.select2Options,e,n),o.select2Elem.select2(o.select2Options)},o.onOptionSelected=function(e){var t=o.beforeOptionSelected||function(){return!0},i=o.onAfterOptionSelected||function(){return!0};n.when(t(e)).then(function(t){1==t?(o.ngModel=e,n.when(i(e)).then(function(){})):o.selectOption(o.ngModel)})},o.selectOption=function(e){null==e?o.select2Elem.val(null).trigger("change"):o.select2Elem.val(e).trigger("change")},o.onLoad()}}}]),angular.module("cccis.angular.common.components.inputField").directive("cccisLabelField",[function(){return{restrict:"E",transclude:!0,replace:!0,scope:{caption:"@",requiredMark:"@",ngId:"@",labelFieldClass:"@"},template:'<div class="cccis-label-field {{labelFieldClass}}">   <div title="{{caption}}" class="caption" ng-class="{\'require-mark\':requiredMark==\'true\'}">{{caption}}</div>   <div class="field" ng-transclude></div></div>',link:function(e,n,o,t){e.onLoad=function(){},e.onLoad()}}}]),angular.module("cccis.angular.common.components.inputField").directive("cccisLayDateRangeField",["$timeout","$q",function(e,n){return{restrict:"E",replace:!0,scope:{ngId:"@",dateType:"@",dateRangeStart:"=",dateRangeEnd:"=",min:"@",max:"@",placeholder:"@",ngDisabled:"=",datetimeRangeFieldClass:"@",notAfterToday:"@",onDataChanged:"="},template:'<div class="text-field datetime-field datetime-range-field {{datetimeRangeFieldClass}}">   <text-field ng-model="dateRangeModel" type="text" placeholder="{{placeholder}}"/></div>',link:function(e,n,o){e.onLoad=function(){_.includes(["datetime","date"],e.dateType)?(e.min=e.min||"1900-1-1",e.max=e.max||"2099-12-31"):(e.dateType="datetime",e.min=e.min||"1900-1-1 00:00:00",e.max=e.max||"2099-12-31 00:00:00"),e.dateRangeModel=null,e.$watch("dateRangeStart",function(){e.dateRangeModel=e.dateRangeStart+" - "+e.dateRangeEnd}),e.$watch("dateRangeEnd",function(){e.dateRangeModel=e.dateRangeStart+" - "+e.dateRangeEnd}),e.$watch("dateRangeModel",function(){var n=null;e.dateRangeModel&&(n=e.dateRangeModel.split(" - ")),n&&2==n.length?(e.dateRangeStart=n[0],e.dateRangeEnd=n[1]):(e.dateRangeStart=null,e.dateRangeEnd=null)}),laydate.render({elem:$("input",n)[0],type:e.dateType,range:!0,min:e.min,max:e.max,ready:function(n,o){e.$apply(function(){console.log("ready")})},render:function(n){e.$apply(function(){console.log("render")})},change:function(n,o,t){e.$apply(function(){console.log("change")})},done:function(n,o,t){e.$apply(function(){console.log("value:"+n);var o=null;n&&(o=n.split(" - ")),o&&2==o.length?(e.dateRangeStart=o[0],e.dateRangeEnd=o[1]):(e.dateRangeStart=null,e.dateRangeEnd=null)})}})},e.onInputFocus=function(e){$(e.target).closest(".field").addClass("focus"),$(e.target).select()},e.onInputBlur=function(e){$(e.target).closest(".field").removeClass("focus")},e.onLoad()}}}]),angular.module("cccis.angular.common.components.inputField").directive("cccisRadioField",["$timeout",function(e){return{restrict:"E",replace:!0,scope:{group:"@",ngModel:"=",ngValue:"=",ngClick:"=",caption:"@",disabled:"@",uncheckable:"@",radioFieldClass:"@"},template:'<div class="cccis-radio-field {{radioFieldClass}}"><div ng-click="onRadioClick()"  >   <input type="radio" name="{{group}}" ng-model="ngModel" ng-value="ngValue"/>   <div ng-class="{'+"       'field icon radio-normal-unchecked-icon' : (ngModel!=ngValue && disabled!='true'),        'field icon radio-normal-checked-icon': (ngModel==ngValue && disabled!='true'),       'field icon radio-disabled-checked-icon': (ngModel!=ngValue && disabled=='true'),       'field icon radio-disabled-unchecked-icon': (ngModel==ngValue && disabled=='true')        }\"></div>   <div class=\"caption\">{{caption}}</div></div>",link:function(e,n,o){e.caption=e.caption||"",e.onRadioClick=function(){"true"==e.uncheckable&&e.ngModel==e.ngValue?e.ngModel=null:e.ngModel=e.ngValue,e.ngClick&&e.ngClick()}}}}]),angular.module("cccis.angular.common.components.inputField").directive("radioGroupField",["$timeout",function(e){return{restrict:"E",replace:!0,scope:{group:"@",ngModel:"=",optionList:"=",optionText:"@",optionValue:"@",onItemChanged:"=",disabled:"@",uncheckable:"@",radioGroupFieldClass:"@"},template:'<div class="cccis-radio-group-field {{radioGroupFieldClass}}">   <div ng-repeat="option in optionList" ng-click="onRadioClick(option)" class="option" title="{{option[optionText]}}">       <input type="radio" name="{{group}}" ng-model="$parent.ngModel" ng-value="option[optionValue]"/>       <div class="icon" ng-class="{'+"           'radio-normal-unchecked-icon' : (ngModel!=option[optionValue] && disabled!='true'),            'radio-normal-checked-icon': (ngModel==option[optionValue] && disabled!='true'),           'radio-disabled-checked-icon': (ngModel!=option[optionValue] && disabled=='true'),           'radio-disabled-unchecked-icon': (ngModel==option[optionValue] && disabled=='true')            }\"></div>       <div class=\"caption\">{{option[optionText]}}</div>   </div></div>",link:function(n,o,t){n.group=n.group||_.uniqueId("radio-group-"),n.onRadioClick=function(t){"true"==n.uncheckable&&n.ngModel==t[n.optionValue]?n.ngModel=null:n.ngModel=t[n.optionValue],n.onItemChanged&&e(function(){n.onItemChanged(n.ngModel)});var i=document.createEvent("HTMLEvents");return i.initEvent("change",!0,!0),i.eventType="message",o[0].dispatchEvent?o[0].dispatchEvent(i):o[0].fireEvent?o[0].fireEvent("onchange",i):void 0}}}}]),angular.module("cccis.angular.common.components.inputField").directive("cccisNumberField",["$timeout",function(e){var n=[{key:"partQty",len:3,min:1,max:999,pattern:/^\+?[1-9][0-9]*$/,description:"配件数量，整数格式"},{key:"number",len:60,min:null,max:null,pattern:/^\s*(\-|\+)?(\d+|(\d*(\.\d*)))\s*$/,description:"数值类型"}],o=function(e){return null==(e=_.find(n,{key:e}))?_.find(n,{key:"number"}):e};return{require:"ngModel",restrict:"E",replace:!0,scope:{name:"@",ngModel:"=",type:"@",ngDisabled:"=",numberFieldClass:"@",invalidFlag:"@",placeholder:"@",maxlength:"@",onDataChange:"=",inputIconSupport:"@",inputIconCls:"@",actionBtnSupport:"@",actionBtnCaption:"@",onActionBtnClicked:"=",ngId:"@"},template:'<div class="cccis-text-field cccis-number-field input-group field {{numberFieldClass}}" ng-class="{\'disabled\': ngDisabled}">   <input ng-if="ngDisabled!=\'true\'" id="{{ngId}}" type="text" name="{{name}}" ng-model="ngModel" ng-change="keyPressValidator()" class="form-control {{input-cls}}"        maxlength="{{maxlength}}" autocomplete="off" autocorrect="off" disableautocomplete placeholder="{{placeholder}}"       ng-change="onDataChanged()" ng-blur="onInputBlur()" ng-focus="onInputFocus()"/>   <input ng-if="ngDisabled==\'true\'" id="{{ngId}}" type="{{inputType.type}}" ng-model="ngModel" class="form-control {{input-cls}}" disable="true"/>   <div ng-if="actionBtnSupport==\'true\'" ng-click="clickActionBtn" class="input-group-addon action-btn {{actionBtnCls}}">{{actionBtnCaption}}</div></div>',link:function(n,t,i,l){var a;n.type=n.type||"number",n.name=n.name||"",n.inputType=o(n.type),n.maxlength=null!=n.maxlength?n.maxlength:n.inputType.len,n.onLoad=function(){a=n.ngModel},n.keyPressValidator=function(){n.isInputInvalid=!1;var e=n.ngModel;null!=e&&""!=e&&n.inputType.pattern&&(n.inputType.pattern.test(e)||(n.isInputInvalid=!0)),n.isInputInvalid?n.ngModel=a:a=n.ngModel},n.valueChangeValidator=function(){var e=n.inputType.max;null!=e&&Number(n.ngModel)>e&&n.setModelValue(e);var o=n.inputType.min;null!=o&&Number(n.ngModel)<o&&n.setModelValue(o)},n.setModelValue=function(e){n.ngModel=e,a=e},n.onInputFocus=function(){$(".field",t).addClass("focus"),$(".form-control",t).select()},n.onInputBlur=function(){$(".field",t).removeClass("focus"),n.valueChangeValidator(),e(function(){n.onDataChange&&n.onDataChange()})},n.clickActionBtn=function(){n.onActionBtnClicked&&n.onActionBtnClicked()},n.onLoad()}}}]),angular.module("cccis.angular.common.components.inputField").directive("cccisPasswordField",function(){return{restrict:"E",replace:!0,scope:{ngModel:"=",placeholder:"@",ngDisabled:"=",passwordFieldClass:"@",ngId:"@"},template:'<div class="cccis-text-field cccis-password-field input-group field {{passwordFieldClass}}" ng-class="{\'disabled\': ngDisabled}">       <input id="{{ngId}}" type="{{pwdType}}" ng-model="ngModel" placeholder="{{placeholder}}" maxlength="14"                autocorrect="false" autocomplete="new-password" class="form-control {{input-cls}}"                ng-blur="onInputBlur()" ng-focus="onInputFocus()"/>       <span ng-if="pwdType!=\'text\' && ngModel.length > 0" class="input-group-inner-addon glyphicon glyphicon-eye-open" title="显示密码" ng-click="changePwdType()"></span>       <span ng-if="pwdType==\'text\'  && ngModel.length > 0" class="input-group-inner-addon glyphicon glyphicon-eye-close" title="隐藏密码" ng-click="changePwdType()"></span></div>',link:function(e,n){e.pwdType="password",e.changePwdType=function(){e.pwdType="password"==e.pwdType?"text":"password"},e.$watch("ngModel",function(n,o){var t=/^[A-Za-z0-9]+$/;null!=n&&""!=n&&null!=n.trim()&&(t.test(n)?e.ngModel=n:e.ngModel=o)}),e.onInputFocus=function(){$(".field",n).addClass("focus"),$(".form-control",n).select()},e.onInputBlur=function(){$(".field",n).removeClass("focus")}}}}),angular.module("cccis.angular.common.components.inputField").directive("cccisRemarkField",[function(){return{restrict:"E",require:"ngModel",replace:!0,scope:{caption:"@",requiredMark:"@",ngId:"@",ngModel:"=",ngDisabled:"=",remarkFieldClass:"@",maxLength:"@"},template:'<div class="cccis-remark-field {{remarkFieldClass}}">   <div class="header">       <div class="caption">           <label ng-if="requiredMark==\'true\'" class="required-mark">*</label>           <label title="{{caption}}">{{caption}}</label>       </div>       <div class="word-counter">({{length}}/{{maxLength}})</div>   </div>   <textarea ng-model="ngModel" ng-trim="false"  ng-disabled="{{ngDisabled}}" maxlength="{{ctrl.maxLength}}" class="content"></textarea></div>',link:function(e,n,o,t){e.onLoad=function(){e.$watch("ngModel",function(){var n=e.ngModel;e.length=n?n.replace(/\n/g,"").length:0;var o=Number(e.maxLength);e.length>o&&(n=n.substring(0,n.length-(e.length-o))),e.ngModel=n})},e.onLoad()}}}]),angular.module("cccis.angular.common.components.inputField").directive("cccisTextField",["$timeout",function(e){var n=[{key:"text",type:"text",len:60,pattern:"",description:""},{key:"name",type:"text",len:60,pattern:/[&\|\\\*^%$#@\-]/g,description:"姓名,联系人,合同联系人"},{key:"url",type:"url",len:60,pattern:"",description:"URL类型"},{key:"address",type:"text",len:500,pattern:/[&\|\\\*^%$#@\-]/g,description:"地址"},{key:"tel",type:"tel",len:20,pattern:/^(\d|\-|\(|\)|\s)*$/,description:"电话号码，手机号"},{key:"email",type:"email",len:20,pattern:"",description:"邮件"},{key:"captcha",type:"text",len:4,pattern:"",description:""},{key:"orderNo",type:"text",len:100,pattern:/[^a-zA-Z0-9/\s/g]/g,description:""}],o=function(e){return null==(e=_.find(n,{key:e}))?_.find(n,{key:"text"}):e};return{require:"ngModel",restrict:"E",replace:!0,scope:{ngId:"@",ngModel:"=",type:"@",placeholder:"@",ngDisabled:"@",textFieldClass:"@",actionBtnSupport:"@",actionBtnCaption:"@",onActionBtnClicked:"=",onDataChanged:"&"},template:'<div class="text-field input-group {{textFieldClass}}" ng-class="{\'disabled\': ngDisabled}">   <input ng-if="ngDisabled!=\'true\'" id="{{ngId}}" type="{{inputType.type}}" ng-model="ngModel" class="form-control {{input-cls}}"                maxlength="{{inputType.len}}" autocomplete="off" autocorrect="off" disableautocomplete placeholder="{{placeholder}}"               ng-change="onDataChanged()" ng-blur="onInputBlur()" ng-focus="onInputFocus()"/>   <input ng-if="ngDisabled==\'true\'" id="{{ngId}}" type="{{inputType.type}}" ng-model="ngModel" class="form-control {{input-cls}}" disable="true"/>   <div ng-if="actionBtnSupport==\'true\'" ng-click="clickActionBtn" class="input-group-addon action-btn {{actionBtnCls}}">{{actionBtnCaption}}</div></div>',link:function(e,n,t,i){e.type=e.type||"text",e.inputType=o(e.type),e.onLoad=function(){i.$formatters.push(function(n){"tel"!=e.type&&"number"!=e.type&&"url"!=e.type&&e.inputType.pattern&&n&&(n=n.replace(e.inputType.pattern,"")),e.ngModel=n}),e.$watch("ngModel",function(n,o){"tel"===e.type&&null!=n&&""!=n&&null!=n.trim()&&(e.inputType.pattern.test(n)?e.ngModel=n:e.ngModel=o),"url"===e.type&&null!=e.ngModel&&""!=e.ngModel&&null!=e.ngModel.trim()&&(e.inputType.pattern.test(e.ngModel)||(e.ngModel=""))})},e.onInputFocus=function(){$(".text-field",n).addClass("focus"),$(".form-control",n).select()},e.onInputBlur=function(){$(".text-field",n).removeClass("focus")},e.clickActionBtn=function(){e.onActionBtnClicked&&e.onActionBtnClicked()},e.onLoad()}}}]),angular.module("cccis.angular.common.components.loadingMask").directive("cccisLoadingMask",["$rootScope","cccisLoadingMaskProvider",function(e,n){return{restrict:"E",replace:!0,scope:{},link:function(e,o,t){e.queryMessage=e.message,n.setLoadingInstance(function(n,o){1==n?(e.message=o||"请稍候。。。",angular.element(".loading-mask").css("display","flex")):(e.message="",angular.element(".loading-mask").css("display","none"))})},template:'<div class="cccis-loading-mask">       <div class="blank"/>       <img class="loading-mask-img" src="images/loading-mask-image.gif"/>       <span class="loading-mask-msg">{{message}}</span>       <div class="blank"/>   </div></div>'}}]),angular.module("cccis.angular.common.components.loadingMask").factory("cccisLoadingMaskProvider",[function(){var e,n=0;return{start:function(o){e(n=1,o)},complete:function(){e(n=0)},status:n,setLoadingInstance:function(n){e=n}}}]),angular.module("cccis.angular.common.components.notify").directive("cccis-notify",["$compile","$timeout",function(e,n){return{restrict:"EA",scope:{options:"=",api:"="},replace:!0,transclude:!0,link:function(e,n,o){e.onLoad=function(){n.css({left:"0px",top:"0px"})},e.onLoad()},template:'<div class="cccis-notify">   <div ng-if="closable==\'true\'" ng-click="close()" class="icon close-icon" style="cursor: pointer;z-index: 9000;"/>   <div class="content">{{content}}</div></div>'}}]),angular.module("cccis.angular.common.components.notify").provider("cccisNotifyProvider",[function(){return{$get:function(e,n,o,t,i,l,a){return{notify:function(e,n,i){var c=l.defer();e=e||"notification",n=null==n?2e3:n,i=null==i?1:i;var r=null,s=null;return function(){var n='<div class="cccis-notify">   <div class="icon close-icon cursor-pointer" ng-click="close()"></div>   <div class="message">'+e+"</div></div>",i=angular.element(n);r=o.$new(),s=t(i)(r),$("body").append(s),s.css("top",-1*s.outerHeight(!0)),s.css("visibility","visible"),r.close=function(){s.remove()}}(),a(function(){c.resolve(r),s.css("transition","top "+i+"s"),s.css("top",0),a(function(){n>0&&a(function(){s.css("top",-1*s.outerHeight(!0)),a(function(){s.remove()},1e3*i)},n)},1e3*i)}),c.promise}}}}}]),angular.module("cccis.angular.common.components.panel").directive("cccis-panel",["$timeout",function(e){return{scope:{collapsible:"@",collapsed:"@",withHeading:"@",headingCaption:"@",panelClass:"@",onCollapseStatusChanged:"="},restrict:"E",transclude:!0,link:function(e,n,o){e.onLoad=function(){},e.onPanelHeadingDblClicked=function(){"true"==e.collapsible&&e.changePanelCollapseStatus()},e.changePanelCollapseStatus=function(){e.collapsed?e.collapsed=!1:e.collapsed=!0,e.onCollapseStatusChanged&&e.onCollapseStatusChanged(e.collapsed)},e.onLoad()},template:'<div class="panel panel-primary cccis-panel {{panelClass}}">   <div ng-if="withHeading" class="panel-heading" ng-dblclick="onPanelHeadingDblClicked()">       <div class="caption">{{ headingCaption }}</div>       <div class="action-bar">           <i ng-if="collapsible!=\'false\'" ng-click="changePanelCollapseStatus()" ng-class="{\'glyphicon glyphicon-chevron-down\': !collapsed , \'glyphicon glyphicon-chevron-right\': collapsed}"></i>       </div>   </div>   <div ng-hide="collapsed" class="panel-body" ng-show="initStatus" ng-transclude>   </div></div>'}}]),angular.module("cccis.angular.common.components.panel").directive("cccisPopupPanel",["$templateCache","$timeout",function(e,n){return{restrict:"E",replace:!0,transclude:!0,scope:{panelCls:"@",api:"=",direction:"@",align:"@",arrowFlag:"@",offsetY:"@",boxShadow:"@"},template:'<div class="cccis-popup-panel">   <div ng-if="arrowFlag==\'true\' && actualDirection==\'below\'" style="width:100%;font-size: 30px;text-align: center;line-height:0px;margin-top: 0px;position: absolute;color: #a7bac9;">&#9670;</div>   <div ng-if="arrowFlag==\'true\' && actualDirection==\'below\'" style="width:100%;font-size: 30px;text-align: center;line-height:0px;margin-top: 2px;position: absolute;color: #edf6fb;">&#9670;</div>   <div class="{{panelCls}}" style="width:{{width}};overflow: hidden;" ng-transclude>   </div>   <div ng-if="arrowFlag==\'true\' && actualDirection==\'above\'" style="width:100%;font-size: 30px;text-align: center;line-height:0px;margin-top: 0px;position: relative;color: #a7bac9;">&#9670;</div>   <div ng-if="arrowFlag==\'true\' && actualDirection==\'above\'" style="width:100%;font-size: 30px;text-align: center;line-height:0px;margin-top: -2px;position: relative;color: #edf6fb;">&#9670;</div></div>',link:function(e,o,t){e.onLoad=function(){$("body").append(o),e.$watch("api",function(n,o){e.api&&(e.api.popup=e.popup,e.api.closeWindow=e.closeWindow,e.api.setPosition=e.setPosition)})},e.popup=function(n,o,t){e.show(),e.setPosition(n,o,t)},e.closeWindow=function(){e.hide()},e.setPosition=function(n){e.setPosition(n,null,null)},e.show=function(){o.show();var t=function(n){$(n.target).closest("popup-panel").length<=0?e.hide():$(document).one("click",t)};n(function(){$(document).one("click",t)},500)},e.hide=function(){o.hide()},e.setPosition=function(t,i,l){if(t){var a=$(document.body).css("overflow-x"),c=$(document.body).css("overflow-y");$("body").css("overflow","hidden"),o.css("visibility","hidden"),n(function(){var n=0;n=l>0?l:o.find(".popupPanel").height();var r=e.align;"center"!=r&&"left"!=r&&"right"!=r&&(r="left");var s=t.offset().left,d=t.offset().top+t.height();"left"==r?s=t.offset().left:"center"==r?s=t.offset().left+t.outerWidth()/2-o.outerWidth()/2:"right"==r&&(s=t.offset().left+t.outerWidth()-o.outerWidth());var u=e.direction;"above"!=u&&"below"!=u&&(u=d+n+5>$(window).height()?"above":"below"),e.actualDirection=u,"above"==u?(d=t.offset().top-n-(e.offsetY?parseInt(e.offsetY):0),"true"==e.boxShadow&&o.find(".popupPanel").css("box-shadow","3px -3px 2px gray")):"below"==u&&(d=t.offset().top+t.height()+5+(e.offsetY?parseInt(e.offsetY):0),"true"==e.boxShadow&&o.find(".popupPanel").css("box-shadow","3px 3px 2px gray")),o.css({left:s+"px",top:d+"px"}),l&&$(o.children()[0]).css("height",l+"px"),i&&$(o.children()[0]).css("width",i+2+"px"),o.css("visibility","visible"),$(document.body).css({"overflow-x":a,"overflow-y":c})})}},e.onLoad()}}}]),angular.module("cccis.angular.common.utils").factory("cccisCodeTableUtils",["$q","cccisUrlUtils",function(e,n){var o=function(){var o=e.defer(),t=[];return n.postJsonData("/base/codeTable/listAll",{}).then(function(e){e.result!=n.RESULT.SUCCESS?(console.log(e.message),o.resolve(null)):(t=e.codeTableMap,o.resolve(t))}),o.promise},t=function(e){var n=localStorage.getItem("CODE_TYPE_"+e);return n?JSON.parse(Base64.decode(n)):[]},i=function(e,n){var o=t(e);return _.find(o,{codeId:n})};return{initCodeTable:function(n){var t=e.defer();if(localStorage.getItem("CODE_TYPE_LIST")&&!n)t.resolve(!0);else{var i=[];o().then(function(e){e?(_.each(e,function(e,n){i.push(n),localStorage.setItem("CODE_TYPE_"+n,Base64.encode(JSON.stringify(e)))}),localStorage.setItem("CODE_TYPE_LIST",Base64.encode(JSON.stringify(i))),t.resolve(!0)):t.resolve(!1)})}return t.promise},getCodesByType:t,getCodeByTypeAndCode:i,getCodeValueByTypeAndCode:function(e,n){var o=i(e,n);return o?o.text:o}}}]),angular.module("cccis.angular.common.utils").factory("cccisDecimalUtils",[function(){return{plus:function(e,n,o,t,i){var l=new Decimal(Number(e||0)),a=new Decimal(Number(n||0)),c=new Decimal(Number(o||0)),r=new Decimal(Number(t||0)),s=new Decimal(Number(i||0));return l.plus(a).plus(c).plus(r).plus(s).toNumber()},plusWithP2:function(e,n,o,t,i){var l=this.plus(e,n,o,t,i);return Number(l).toFixed(2)},minus:function(e,n,o){var t=new Decimal(Number(e||0)),i=new Decimal(Number(n||0)),l=t.minus(i).toNumber();return null==o?l:l.toFixed(o)},multiply:function(e,n,o,t,i){var l=null,a=new Decimal(Number(e||0)),c=new Decimal(Number(n||0));if(l=a.mul(c),null==o)return l.toNumber();var r=new Decimal(Number(o||0));if(l=l.mul(r),null==t)return l.toNumber();var s=new Decimal(Number(t||0));if(l=l.mul(s),null==i)return l.toNumber();var d=new Decimal(Number(i||0));return(l=l.mul(d)).toNumber()},multiplyWithP2:function(e,n,o,t,i){var l=this.multiply(e,n,o,t,i);return Number(l).toFixed(2)},multiplyWithP1:function(e,n,o,t,i){var l=this.multiply(e,n,o,t,i);return Number(l).toFixed(1)},dividing:function(e,n,o){return e=e?parseFloat(e+""):0,n?(n=parseFloat(n+""),null==o?parseFloat(Number(e/n)):parseFloat(Number(e/n).toFixed(o))):(n=0,null==o?Number(0):Number(0).toFixed(o))},dividingWithP2:function(e,n){return this.dividing(e,n,2)},dividingWithP1:function(e,n){return this.dividing(e,n,1)}}}]),angular.module("cccis.angular.common.utils").factory("cccisLocalAreaUtils",["$q","cccisUrlUtils",function(e,n){var o=function(){var o=e.defer();return n.postJsonData("/base/localArea/listAll",{}).then(function(e){e.result!=n.RESULT.SUCCESS?(console.log(e.message),o.resolve(null)):o.resolve(e.localAreaMap)}),o.promise},t=function(){var e=localStorage.getItem("KEY_LOCAL_AREA_TREE");return e?JSON.parse(Base64.decode(e)):null},i=function(e){var n=t();return n?n[e]:null};return{initLocalAreaTree:function(){var n=e.defer();return localStorage.getItem("KEY_LOCAL_AREA_TREE")?n.resolve(!0):o().then(function(e){e?(localStorage.setItem("KEY_LOCAL_AREA_TREE",Base64.encode(JSON.stringify(e))),n.resolve(!0)):n.resolve(!1)}),n.promise},getLocalAreaTree:t,getLocalAreaByAreaId:i,buildWholeLocalAddress:function(e){if(null==e)return"";var n=[];if(e.provinceId){var o=i(e.provinceId);o&&n.push(o.areaName)}if(e.cityId){var t=i(e.cityId);t&&n.push(t.areaName)}if(e.distinctId){var l=i(e.distinctId);l&&n.push(l.areaName)}return e.address&&n.push(e.address),n.join("")}}}]),angular.module("cccis.angular.common.utils").factory("cccisUrlUtils",["$location","Restangular","$window","$q",function(e,n,o,t){function i(e){if(angular.isUndefined(r)){var n=o.document.location.pathname;r=n.substring(0,n.substr(1).indexOf("/")+1)}return r+e}function l(e){var n="";return _.each(e,function(e,o){n+=o+"="+e+"&"}),n&&(n=n.substring(0,n.length-1)),n}function a(e,n){if(e.result!=d.SUCCESS&&(null==e.result&&"[object String]"===Object.prototype.toString.call(e)&&e.indexOf("partsApp")>0&&!n&&s&&s.showAppErrorDialog("您的操作已超时，系统将自动退出。").then(function(e){e.onDialogClose=function(){window.location.href=i("")}}),e.result==d.FAILURE))if("1"==e.code)!n&&s&&s.showAppErrorDialog(e.message);else if("2"==e.code)!n&&s&&s.showAppErrorDialog(e.message);else{var o=e&&e.message?e.message:e;console.error("http error:"+o),!n&&s&&s.showAppErrorDialog(o)}}function c(e,n){500==e.status?(!n&&s&&s.showAppErrorDialog("服务器异常。"),console.log(e.statusText)):console.error(e.statusText)}var r,s,d={SUCCESS:"success",FAILURE:"failure"};return{setAppErrorDialogProvider:function(e){s=e},getPath:i,postJsonData:function(e,o,i){var l=t.defer();return n.all(this.getPath(e)).post(o,{},{"Content-Type":"application/json; charset=UTF-8"}).then(function(e){a(e,i),l.resolve(e)},function(e){c(e,i)}),l.promise},postFormData:function(e,o,i){var r=t.defer(),s=l(o);return n.all(this.getPath(e)).post(s,{},{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}).then(function(e){a(e,i),r.resolve(e)},function(e){c(e,i)}),r.promise},getJsonData:function(e,o,i){var l=t.defer();return n.all(this.getPath(e)).get(o,{},{"Content-Type":"application/json; charset=UTF-8"}).then(function(e){a(e,i),l.resolve(e)},function(e){c(e,i)}),l.promise},getFormData:function(e,o,i){var r=t.defer(),s=l(o);return n.all(this.getPath(e)).get(s,{},{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}).then(function(e){a(e,i),r.resolve(e)},function(e){c(e,i)}),r.promise},RESULT:d}}]),angular.module("cccis.angular.common.utils").factory("cccisUserUtils",["cccisUrlUtils","$q","Restangular",function(e,n,o){function t(){return i}function t(){if(null==i){var e=window.sessionStorage.getItem(a);e&&(i=angular.fromJson(e))}return i}var i=null,l=[],a="CURRENT_USER";e.getPath("/authentication/user/getCurrentUser");return{getCurrentUser:t,loadUser:function(){var o=n.defer();if(null==i){var t=window.sessionStorage.getItem(a);t&&"null"!=t?(i=JSON.parse(t),o.resolve(i)):e.postFormData("/authentication/user/getCurrentUser",{}).then(function(n){n.result==e.RESULT.SUCCESS?(i=n.user,o.resolve(i)):(i=null,o.resolve(null))})}else o.resolve(i);return o.promise},simulateLogin:function(o,t){var l=n.defer();return null==o?(console.error("error, param user is null"),l.resolve(null)):e.postJsonData("/authentication/simulateLogin",o,t).then(function(n){n.result==e.RESULT.SUCCESS?(i=n.user,window.sessionStorage.setItem(a,JSON.stringify(i)),l.resolve(n)):(i=null,window.sessionStorage.setItem(a,""),l.resolve(n))}),l.promise},logout:function(){var t=e.getPath("/userAction/userLogout"),c=this,r=n.defer();return o.all(t).post({},{},{"Content-Type":"application/json; charset=UTF-8"}).then(function(n){n.result==e.RESULT.SUCCESS&&(i=null,l=null,window.sessionStorage.removeItem(a),c.loadUserMenuWithPromise().then(function(o){o.result==e.RESULT.SUCCESS&&(l=o.menus),r.resolve(n)}))}),r.promise},clear:function(){i=null}}}]),angular.module("cccis.angular.common.businessComponents.model-validation").run(["$templateCache",function(e){e.put("common/business-components/model-validation/validation-result-dialog.tpl.html",'<div class="cccis-validation-result-dialog">\n    <div class="container">\n        <div ng-repeat="result in validationErrorResultMap" ng-show="result.errorNum>0 || result.warningNum>0">\n            <div id="msg-id-{{result.key}}" class="msg-node" ng-show="isMultiValidationTypeFlag"><span>{{result.title}}提示</span></div>\n            <div ng-repeat="(heading, validators) in result.errors track by $index" class="msg-tab">\n                <div ng-if="validators.length>0" class="msg-head">{{heading}}</div>\n                <div ng-repeat="validator in validators">\n                    <div ng-repeat="errorMsg in validator.errorMsgArray" class="msg-item">\n                        <i class="glyphicon glyphicon-exclamation-sign" style="color:red"></i>\n                        <div style="display: inline" ng-dblclick="locateValidator(validator)">{{errorMsg}}</div>\n                    </div>\n                </div>\n            </div>\n            <hr ng-if="result.showDividingLineFlag" class="msg-bar" size="1/">\n            <div ng-repeat="(heading, validators)  in result.warnings track by $index" class="msg-tab">\n                <div ng-if="validators.length>0" class="msg-head">{{heading}}</div>\n                <div ng-repeat="validator in validators">\n                    <div ng-repeat="errorMsg in validator.errorMsgArray" class="msg-item">\n                        <i class="glyphicon glyphicon-exclamation-sign" style="color:#006fb9"></i>\n                        <div style="display: inline" ng-dblclick="locateValidator(validator)">{{errorMsg}}</div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n    <div ng-if="allowSubmitFlag" class="footer">\n        <button class="ccc-btn-default" ng-click="clickSubmitBtn()">提交核损</button>\n    </div>\n</div>')}]),angular.module("cccis.angular.common.components.dialog").run(["$templateCache",function(e){e.put("common/components/dialog/dialog-alert.tpl.html",'<div class="cccis-common-dialog-content">\n    <div class="content">\n        <div ng-bind="content"></div>\n    </div>\n    <div class="cccis-button-bar">\n        <button class="btn btn-primary close-confirm-btn" ng-click="closeAlert()">确定</button>\n    </div>\n</div>')}]),angular.module("cccis.angular.common.components.dialog").run(["$templateCache",function(e){e.put("common/components/dialog/dialog-confirm.tpl.html",'<div class="cccis-common-dialog-content">\n    <div class="content">\n        <div ng-bind="content"></div>\n    </div>\n\n    <div class="cccis-button-bar">\n        <button class="btn btn-primary" style="font-size: small" autofocus="autofocus" ng-click="confirm()">确认</button>\n        <button class="btn btn-primary close-confirm-btn" style="font-size: small" ng-click="cancel()">取消</button>\n    </div>\n</div>')}]),angular.module("cccis.angular.common.components.grid").run(["$templateCache",function(e){e.put("common/components/grid/auto-height-pagination-grid.tpl.html",'<div class="cccis-pagination-grid cccis-auto-height-pagination-grid">\n    <table class="table table-bordered cccis-table">\n        <thead>\n        <tr>\n            <th ng-if="options.gridHighlightCellStyleFlag" class="grid-highlight-cell">\n            </th>\n            <th ng-if="options.rowCheckable" class="grid-checkbox-cell">\n                <checkbox-field ng-if="options.multiRowCheckable==true" ng-model="allRowCheckedFlag" on-checked="checkAllRows()" checkbox-field-class="checkbox-field-cell">\n            </th>\n            <th ng-repeat="col in columns" ng-style="col.headStyle" ng-class="{\'cursor-pointer\':col.enableSorting==true}" ng-click="sortData(col, columns)">\n                <div ng-if="col.headTemplate" cell-compiler="col.headTemplate" cell-template-scope="col.headTemplateScope"></div>\n                <div ng-if="!col.headTemplate">{{col.displayName || col.field}}</div>\n                <div ng-if="col.sort == \'desc\'"><i class="glyphicon glyphicon-triangle-bottom"></i></div>\n                <div ng-if="col.sort == \'asc\'"><i class="glyphicon glyphicon-triangle-top"></i></div>\n            </th>\n        </tr>\n        </thead>\n        <tbody class="no-data-found" ng-if="options.totalRecordCount == 0">\n        <tr>\n            <td colspan="{{columnCount}}">\n                <div style="height:50px">{{options.noDataMessage}}</div>\n            </td>\n        </tr>\n        </tbody>\n        <tbody class="data-found" ng-if="options.totalRecordCount > 0">\n        <tr ng-repeat="row in gridData" ng-click="selectRow(row)" ng-class="{\'active\':row.$selected}">\n            <td ng-if="options.gridHighlightCellStyleFlag" class="grid-highlight-cell"></td>\n            <td ng-if="options.rowCheckable" class="grid-checkbox-cell">\n                <div class="align-center">\n                    <checkbox-field ng-model="row.$checked" on-checked="checkRow(row)" checkbox-field-class="checkbox-field-cell" ng-disabled="row.$checkable == false">\n                </div>\n            </td>\n            <td ng-repeat="col in columns" class="{{col.cellClass}}" ng-style="col.cellStyle">\n                <div ng-if="col.cellTemplate" cell-compiler="col.cellTemplate"></div>\n                <div ng-if="!col.cellTemplate" title="{{row[col.field]}}">{{row[col.field]}}</div>\n            </td>\n        </tr>\n        </tbody>\n    </table>\n    <cccis-pagination-bar ng-hide="options.totalRecordCount==0" ng-if="options.paginationSupport==true">\n</div>')}]),angular.module("cccis.angular.common.components.grid").run(["$templateCache",function(e){e.put("common/components/grid/fixed-height-pagination-grid.tpl.html",'<div class="cccis-pagination-grid cccis-fixed-height-pagination-grid">\n    <div class="head-container">\n        <table class="table table-bordered cccis-table">\n            <thead>\n            <tr>\n                <th class="grid-highlight-cell">\n                </th>\n                <th ng-if="options.rowCheckable" class="grid-checkbox-cell">\n                    <checkbox-field ng-if="options.multiRowCheckable==true" ng-model="allRowCheckedFlag" on-checked="checkAllRows()" checkbox-field-class="checkbox-field-cell">\n                </th>\n                <th ng-repeat="col in columns" ng-style="col.headStyle" ng-class="{\'cursor-pointer\':col.enableSorting==true}" ng-click="sortData(col, columns)">\n                    <div ng-if="col.headTemplate" cell-compiler="col.headTemplate" cell-template-scope="col.headTemplateScope"></div>\n                    <div ng-if="!col.headTemplate">{{col.displayName || col.field}}</div>\n                    <div ng-if="col.sort == \'desc\'"><i class="glyphicon glyphicon-triangle-bottom"></i></div>\n                    <div ng-if="col.sort == \'asc\'"><i class="glyphicon glyphicon-triangle-top"></i></div>\n                </th>\n            </tr>\n            </thead>\n        </table>\n    </div>\n    <div class="content-container">\n        <table class="table table-bordered cccis-table">\n            <thead>\n            <tr>\n                <th class="grid-highlight-cell">\n                </th>\n                <th ng-if="options.rowCheckable" class="grid-checkbox-cell">\n                    <checkbox-field ng-if="options.multiRowCheckable==true" ng-model="allRowCheckedFlag" on-checked="checkAllRows()" checkbox-field-class="checkbox-field-cell">\n                </th>\n                <th ng-repeat="col in columns" ng-style="col.headStyle" ng-class="{\'cursor-pointer\':col.enableSorting==true}" ng-click="sortData(col, columns)">\n                    <div ng-if="col.headTemplate" cell-compiler="col.headTemplate" cell-template-scope="col.headTemplateScope"></div>\n                    <div ng-if="!col.headTemplate">{{col.displayName || col.field}}</div>\n                    <div ng-if="col.sort == \'desc\'"><i class="glyphicon glyphicon-triangle-bottom"></i></div>\n                    <div ng-if="col.sort == \'asc\'"><i class="glyphicon glyphicon-triangle-top"></i></div>\n                </th>\n            </tr>\n            </thead>\n            <tbody class="no-data-found" ng-if="options.totalRecordCount == 0">\n            <tr>\n                <td colspan="{{columnCount}}">\n                    <div style="height:50px">{{options.noDataMessage}}</div>\n                </td>\n            </tr>\n            </tbody>\n            <tbody class="data-found" ng-if="options.totalRecordCount > 0">\n            <tr ng-repeat="row in gridData" ng-click="selectRow(row)" ng-class="{\'active\':row.$selected}">\n                <td class="grid-highlight-cell"></td>\n                <td ng-if="options.rowCheckable" class="grid-checkbox-cell">\n                    <div class="align-center">\n                        <checkbox-field ng-model="row.$checked" on-checked="checkRow(row)" checkbox-field-class="checkbox-field-cell" ng-disabled="row.$checkable == false">\n                    </div>\n                </td>\n                <td ng-repeat="col in columns" class="{{col.cellClass}}" ng-style="col.cellStyle">\n                    <div ng-if="col.cellTemplate" cell-compiler="col.cellTemplate"></div>\n                    <div ng-if="!col.cellTemplate" title="{{row[col.field]}}">{{row[col.field]}}</div>\n                </td>\n            </tr>\n            </tbody>\n        </table>\n    </div>\n    <cccis-pagination-bar class="fixed-height-pagination-bar" ng-hide="options.totalRecordCount==0" ng-if="options.paginationSupport==true">\n</div>')}]),angular.module("cccis.angular.common.components.grid").run(["$templateCache",function(e){e.put("common/components/grid/pagination-bar.tpl.html",'<div class="pagination-bar cccis-row">\n    <div style="flex:1"></div>\n    <div>共{{options.totalRecordCount}}项，每页</div>\n    <div>\n        <select ng-model="options.pageItemSize" ng-options="di for di in [10, 25, 50]"></select>\n    </div>\n    <div>项</div>\n    <div class="page-bar">\n        <div class="page" ng-click="gotoPage(1)">\n            <div><span class="icon nav-left-icon" ng-class="options.currentPage==1?\'not-active\':\'\'"></span></div>\n        </div>\n        <div class="page" ng-if="options.currentGroup > 1" ng-click="gotoPage(firstPageInCurrentGroup - options.groupItemSize)">\n            <div><span class="">...</span></div>\n        </div>\n        <div class="page" ng-repeat="page in pageArray" ng-class="page == options.currentPage?\'page active\':\'page\'" ng-click="gotoPage(page)">\n            <div><span class="">{{page}}</span></div>\n        </div>\n        <div class="page" ng-if="options.currentGroup < maxGroupNum" ng-click="gotoPage(lastPageInCurrentGroup+1)">\n            <div><span class="">...</span></div>\n        </div>\n        <div class="page" ng-click="gotoPage(maxPageNum)">\n            <div><span class="icon nav-right-icon" ng-class="(options.currentPage==maxPageNum)?\'not-active\':\'\'"></span></div>\n        </div>\n    </div>\n</div>')}]);